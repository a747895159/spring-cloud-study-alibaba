
# 0.参考文档
    Alpha 指的是内测、Beta 指的是公测、RC 正式发布的候选版本
    ShardingSphere 可插拔架构,已实现数据分片、读写分离、数据加密、影子库、数据库发现等功能。
```
    https://blog.csdn.net/xinzhifu1/article/details/109309303  分片策略 学习
    https://blog.csdn.net/dhaibo1986/article/details/120397730  对接中存在的一些坑
    https://shardingsphere.apache.org/document/5.0.0-RC1/cn/user-manual/shardingsphere-jdbc/configuration/java-api/sharding/  官方文档
```


# 1.Sharding-JDBC 分库分表规则
- **Hash取模分表**：按商户Id取模
    - 优点：数据分片相对比较均匀，不容易出现热点和并发访问的瓶颈。
    - 缺点：后期扩容时，需要迁移旧的数据很难；跨分片查询复杂,需要在内存中合并数据返给应用。

- **数值Range分表**:按商户Id区间分表
    - 优点：单表大小可控;扩容方便,无需对其他分片数据迁移；可快速进行范围查询，避免分片问题。
    - 缺点：热点数据成为性能瓶颈
    
- **一致性Hash算法分表**
    - 优点具有Hash取模分表的优点,可以很好解决扩容问题，也会存在迁移旧的数据的难题。

- SQL解析：
     - 目前不支持union、部分子查询、函数内分片等不太适用在分片场景中出现的SQL解析
     - 支持join、aggregation（包括avg）、order by、 group by、limit、甚至or查询等复杂SQL的解析

# 2. 分库分表常见方案

|        | MyCat         | Sharding-JDBC |
| ----   | :---:          | :---: |
| 分库    | 有            | 有 |
| 分表    | 无            | 有 |
| 中间层   | 有           | 无 |
| ORM支持   | 任意        | 任意 |
| 数据库支持 | 仅MySQL     | 任意 |

- MyCat 基于阿里的cobar基础二次开发，社区活跃度很高。


# 3.Sharding-JDBC 内置分片算法

InlineShardingAlgorithm	    基于行表达式的分片算法
ModShardingAlgorithm	    基于取模的分片算法
HashModShardingAlgorithm	基于哈希取模的分片算法
VolumeBasedRangeShardingAlgorithm	基于分片容量的范围分片算法
BoundaryBasedRangeShardingAlgorithm	基于分片边界的范围分片算法

ComplexKeysShardingAlgorithm  复合(多分片建)分片算法

# 4.Sharding-JDBC 三种主键生成策略
- UUID生成策略、雪花生成策略、基于 KeyGenerateAlgorithm 自定义策略
ShardingJdbc的雪花算法强依赖时间、时钟回拨，会产生重复的ID。

